(function(e){function t(t){for(var a,o,i=t[0],c=t[1],l=t[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={app:0},s=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/forecast-web-app/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a,r,s=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[e._v(" Оценка риска конвективных ОЯ на территории Урала "),n("v-spacer"),n("order-notification"),n("auth")],1),n("v-main",[n("Map"),n("Options"),n("Legend")],1),n("Footer")],1)},i=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("l-map",{ref:"map",attrs:{"min-zoom":3}},[e.postitonLatLng?n("l-marker",{attrs:{"lat-lng":e.postitonLatLng}},[n("l-popup",[e._v("Ваша геопозиция")])],1):e._e(),n("risk-layer",{attrs:{"is-visible":"vector"===e.selectedDisplayType}}),n("l-tile-layer",{attrs:{url:e.osmURL}}),n("l-tiff",{attrs:{"is-visible":e.indexActive,url:e.indexURL,"info-popup":!0,"type-raster":"index"}}),n("l-tiff",{attrs:{"is-visible":"raster"===e.selectedDisplayType,url:e.rasterURL,"info-popup":!0,"type-raster":"not-index"}})],1)},l=[],u=n("5530"),d=(n("a15b"),n("d81d"),n("2699")),p=n("a40a"),v=n("4e2b"),f=n("f60f"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("l-geo-json",{attrs:{geojson:e.geoJSONData,visible:!e.error_get_data&&e.isVisible,options:e.optionsGeoJSON}})},g=[],h=n("1da1"),m=(n("96cf"),n("99af"),n("d3b7"),n("7db0"),n("044a")),E=n("2f62"),_={name:"RiskLayer",components:{LGeoJson:m["a"]},props:{isVisible:{type:Boolean,required:!0}},data:function(){return{data:null,tooltipFields:[{field:"level_risk",alias:"Уровень риска"}],error_get_data:!0,style:function(){}}},computed:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(E["e"])(["selectedModel","SELECTED_EVENT_GROUP"])),Object(E["c"])(["SELECTED_HOUR","SELECTED_DATE","SELECTED_EVENT_GROUP"])),{},{geoJSONData:function(){return this.isVisible&&this.data&&!this.error_get_data?this.data:[]},geoJSONVisibility:function(){return!0},optionsGeoJSON:function(){return{onEachFeature:this.onEachFeature,style:this.style}},onEachFeature:function(){var e=this;return function(t,n){var a=function(e,n){return e+"<div>"+"".concat(n.alias," : ").concat(t.properties[n.field])+"<div>"};n.bindTooltip(e.tooltipFields.reduce(a,""))}},geojsonURL:function(){var e="".concat("http://ogs.psu.ru:5001/api/v1","/get_forecast?"),t=["model=".concat(this.selectedModel),"date=".concat(this.SELECTED_DATE),"hour=".concat(this.SELECTED_HOUR),"group=".concat(this.SELECTED_EVENT_GROUP),"datatype=vector"];return e+t.join("&")}}),watch:{geojsonURL:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getGeoJSONData(e.geojsonURL);case 2:n=t.sent,e.data=n;case 4:case"end":return t.stop()}}),t)})))()},SELECTED_EVENT_GROUP:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,a,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="".concat("http://ogs.psu.ru:5001/api/v1","/get_legend?"),a=["model=".concat(e.selectedModel),"group=".concat(e.SELECTED_EVENT_GROUP)],r=n+a.join("&"),t.next=5,fetch(r).then((function(e){return e.json()}));case 5:s=t.sent,e.style=function(t){return e.findColor(s,t.properties.level_risk)};case 7:case"end":return t.stop()}}),t)})))()}},methods:{getGeoJSONData:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(e);case 3:return a=n.sent,n.next=6,a.json();case 6:if(r=n.sent,a.ok){n.next=9;break}return n.abrupt("return",null);case 9:return t.error_get_data=!1,n.abrupt("return",r);case 13:return n.prev=13,n.t0=n["catch"](0),console.log(n.t0),t.error_get_data=!0,n.abrupt("return",null);case 18:case"end":return n.stop()}}),n,null,[[0,13]])})))()},findColor:function(e,t){var n=e.find((function(e){var n=e.levelCode;return n===t})),a=n.color;return{fillColor:a,weight:1,color:a}}}},x=_,y=n("2877"),C=Object(y["a"])(x,b,g,!1,null,null,null),T=C.exports,O=(n("b680"),n("e11e")),D=n.n(O),V={name:"LTiff",props:{url:{type:String,required:!0},isVisible:{type:Boolean,required:!0},infoPopup:{type:Boolean,required:!0},typeRaster:{type:String,required:!0}},data:function(){return{layer:null,rasterData:null,opacity:.5,popup:null}},computed:Object(u["a"])({},Object(E["e"])(["selectedModel","indexColor","riskColor"])),watch:{url:function(){this.isVisible&&this.createLayer()},isVisible:function(){this.isVisible?this.layer?this.layer.setOpacity(this.opacity):this.createLayer():(this.layer.setOpacity(0),this.popup&&this.popup.remove())}},beforeMount:function(){this.parentContainer=this.findRealParent(this.$parent),this.map=this.parentContainer.mapObject;var e=document.createElement("script");e.src="https://ihcantabria.github.io/Leaflet.CanvasLayer.Field/dist/leaflet.canvaslayer.field.js",e.async=!0,document.body.appendChild(e)},methods:Object(u["a"])(Object(u["a"])({},Object(E["d"])({setIndexRange:"SET_INDEX_RANGE"})),{},{findRealParent:function(e){var t=!1;while(e&&!t)void 0===e.mapObject?e=e.$parent:t=!0;return e},displayPopup:function(e){if(this.isVisible){var t=e.value;null!==t&&void 0!==t?(this.popup.setLatLng([e.latlng.lat,e.latlng.lng]).openOn(this.map),this.popup.setContent("Значение растра в точке: ".concat(parseFloat(t).toFixed(2)))):this.popup.remove()}},createLayer:function(){var e=this;this.rasterData?d3.request(this.url).responseType("arraybuffer").get((function(t,n){e.rasterData=D.a.ScalarField.fromGeoTIFF(n.response),e.layer.setData(e.rasterData),e.setIndexRange(e.rasterData.range),e.layer.setColor(chroma.scale("index"===e.typeRaster?e.indexColor:e.riskColor).domain(e.rasterData.range))})):d3.request(this.url).responseType("blob").get(function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(n,a){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.response.arrayBuffer();case 2:r=t.sent,e.rasterData=D.a.ScalarField.fromGeoTIFF(r),e.setIndexRange(e.rasterData.range),e.layer=D.a.canvasLayer.scalarField(e.rasterData,{color:chroma.scale("index"===e.typeRaster?e.indexColor:e.riskColor).domain(e.rasterData.range),opacity:e.opacity}).addTo(e.map),e.infoPopup&&(e.popup=D.a.popup(),e.layer.on("mousemove",(function(t){e.displayPopup(t)})));case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}}),render:function(){return null}},S=V,j=Object(y["a"])(S,a,r,!1,null,null,null),L=j.exports;delete O["Icon"].Default.prototype._getIconUrl,O["Icon"].Default.mergeOptions({iconRetinaUrl:n("584d"),iconUrl:n("6397"),shadowUrl:n("e2b9")});var k={name:"Map",components:{LMap:d["a"],LTileLayer:p["a"],RiskLayer:T,LTiff:L,LMarker:v["a"],LPopup:f["a"]},data:function(){return{osmURL:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",map:null,postitonLatLng:null}},computed:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(E["e"])(["selectedModel","selectedIndex","indexActive","selectedDisplayType"])),Object(E["c"])(["SELECTED_HOUR","SELECTED_DATE","SELECTED_EVENT_GROUP"])),{},{rasterURL:function(){var e="".concat("http://ogs.psu.ru:5001/api/v1","/get_forecast?"),t=["model=".concat(this.selectedModel),"date=".concat(this.SELECTED_DATE),"hour=".concat(this.SELECTED_HOUR),"group=".concat(this.SELECTED_EVENT_GROUP),"datatype=".concat(this.selectedDisplayType)];return e+t.join("&")},indexURL:function(){var e="".concat("http://ogs.psu.ru:5001/api/v1","/get_index?"),t=["model=".concat(this.selectedModel),"date=".concat(this.SELECTED_DATE),"hour=".concat(this.SELECTED_HOUR),"index_name=".concat(this.selectedIndex)];return e+t.join("&")}}),mounted:function(){navigator.geolocation.getCurrentPosition(this.geoSuccess,(function(){}))},methods:{geoSuccess:function(e){this.$refs.map.mapObject.setView(Object(O["latLng"])(e.coords.latitude,e.coords.longitude),5),this.postitonLatLng=Object(O["latLng"])(e.coords.latitude,e.coords.longitude)}}},w=k,I=Object(y["a"])(w,c,l,!1,null,null,null),R=I.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",{attrs:{align:"center","justify-sm":"space-around"}},[n("v-col",{attrs:{cols:"2",sm:"1"}},[n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.setConfigVisibility(!0)}}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-cog-outline ")])],1)],1),n("v-col",{attrs:{cols:"4",sm:"2"}},[n("v-tooltip",{attrs:{top:"","z-index":"1000"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.attrs;return[n("v-btn",e._b({staticClass:"d-flex d-sm-flex",on:{click:function(t){e.dateIsActive=!e.dateIsActive}}},"v-btn",a,!1),[e._v(" "+e._s(e.selectedDate)+" ")])]}}]),model:{value:e.dateIsActive,callback:function(t){e.dateIsActive=t},expression:"dateIsActive"}},[n("div",{staticClass:"date-picker-wrapper"},[n("v-date-picker",{attrs:{locale:"ru-ru","allowed-dates":e.availableDatesFunc},model:{value:e.selectedDate,callback:function(t){e.selectedDate=t},expression:"selectedDate"}})],1)])],1),n("v-col",{attrs:{cols:"4",sm:"8"}},[n("v-slide-group",{staticClass:"d-none d-sm-flex",attrs:{"show-arrows":"","center-active":""},model:{value:e.selectedHour,callback:function(t){e.selectedHour=t},expression:"selectedHour"}},e._l(e.forecastHours,(function(t,a){return n("v-slide-item",{key:a,staticClass:"ma-1",attrs:{value:t.value},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.active,s=a.toggle;return[n("v-btn",{attrs:{"input-value":r,"active-class":"purple white--text",depressed:"",rounded:""},on:{click:s}},[e._v(" "+e._s(t.label)+" ")])]}}],null,!0)})})),1),n("div",{staticClass:"d-xs-flex d-sm-none"},[n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.moveHour(-1)}}},[n("v-icon",[e._v(" mdi-skip-previous ")])],1),n("span",{style:{fontSize:"0.875rem",fontWeight:500}},[e._v(" "+e._s(e.selectedHourLabel)+" ")]),n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.moveHour(1)}}},[n("v-icon",[e._v(" mdi-skip-next ")])],1)],1)],1),n("v-col",{attrs:{cols:"2",sm:"1"}},[n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.setLegendVisibility(!0)}}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-map-legend ")])],1)],1)],1)],1)},A=[],N=(n("caad"),n("2532"),n("c740"),n("25f0"),function(e,t){var n=e.getUTCMonth()+1;n=n<10?"0".concat(n):n.toString();var a=e.getUTCDate();a=a<10?"0".concat(a):a.toString();var r=[e.getFullYear(),n,a];return r.join(t||"")}),P={data:function(){return{dateIsActive:!1,selectedHour:3,selectedHourLabel:"03:00",selectedDate1:N(new Date,"-"),selectedDate:"2021-05-15",availableDates:[]}},computed:Object(u["a"])(Object(u["a"])({},Object(E["e"])(["selectedModel","forecastHours"])),{},{selectedDateObj:function(){var e=new Date(this.selectedDate);return e.setHours(this.selectedHour),e}}),watch:{selectedDateObj:function(e){this.setDate(e)}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,a,r,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="".concat("http://ogs.psu.ru:5001/api/v1","/get_dates?"),a=["model=".concat(e.selectedModel)],r=n+a.join("&"),t.next=5,fetch(r);case 5:return s=t.sent,t.next=8,s.json();case 8:o=t.sent,e.availableDates=o;case 10:case"end":return t.stop()}}),t)})))()},methods:Object(u["a"])(Object(u["a"])({},Object(E["d"])({setConfigVisibility:"SET_CONFIG_VISIBILITY",setLegendVisibility:"SET_LEGEND_VISIBILITY",setDate:"SET_SELECTED_DATE"})),{},{availableDatesFunc:function(e){return this.availableDates.includes(e)},moveHour:function(e){var t=this,n=this.forecastHours.findIndex((function(e){var n=e.value;return n===t.selectedHour}));this.forecastHours[n+e]&&(this.selectedHour=this.forecastHours[n+e].value,this.selectedHourLabel=this.forecastHours[n+e].label)}})},U=P,G=(n("b966"),n("6544")),H=n.n(G),F=n("8336"),Y=n("62ad"),B=n("a523"),$=n("2e4b"),q=n("132d"),z=n("0fd9"),J=n("7efd"),X=n("9dbe"),W=n("3a2f"),K=Object(y["a"])(U,M,A,!1,null,"9f89516c",null),Q=K.exports;H()(K,{VBtn:F["a"],VCol:Y["a"],VContainer:B["a"],VDatePicker:$["a"],VIcon:q["a"],VRow:z["a"],VSlideGroup:J["a"],VSlideItem:X["a"],VTooltip:W["a"]});var Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-snackbar",{style:{zIndex:1002},attrs:{left:"",bottom:"",value:e.isVisible,timeout:"-1","max-width":"100"}},[n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{justify:"end"}},[n("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(t){return e.setConfigVisibility(!1)}}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-close ")])],1)],1),n("v-row",{staticClass:"pa-0"},[n("v-col",{staticClass:"pa-0"},[e._v(" Модель ")])],1),n("v-row",{staticClass:"pa-0"},[n("v-col",{staticClass:"pa-0",attrs:{cols:"10"}},[n("v-select",{attrs:{items:e.models,filled:"",label:"Модель",dense:"",solo:""},model:{value:e.selectedModel,callback:function(t){e.selectedModel=t},expression:"selectedModel"}})],1),n("v-col",{staticClass:"pa-0",attrs:{cols:"2"}},[n("v-btn",{staticClass:"mx-4",attrs:{icon:""},on:{click:function(t){e.dialog=!0,e.menusection="model"}}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-information ")])],1)],1)],1),n("v-row",{staticClass:"pa-0"},[n("v-col",{staticClass:"pa-0"},[e._v(" Группа явлений ")])],1),n("v-row",{staticClass:"pa-0"},[n("v-col",{staticClass:"pa-0",attrs:{cols:"10"}},[n("v-select",{attrs:{label:"Выберите группу",items:e.eventGroups,"item-text":"alias",filled:"",dense:"",solo:"","return-object":""},model:{value:e.selectedEvent,callback:function(t){e.selectedEvent=t},expression:"selectedEvent"}})],1),n("v-col",{staticClass:"pa-0",attrs:{cols:"2"}},[n("v-btn",{staticClass:"mx-4",attrs:{icon:""},on:{click:function(t){e.dialog=!0,e.menusection="eventgroup"}}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-information ")])],1)],1)],1),n("v-row",{staticClass:"pa-0",attrs:{"align-content":"center",justify:"space-between",align:"baseline"}},[n("v-row",{staticClass:"pa-0"},[n("v-col",{attrs:{cols:"12"}},[n("v-radio-group",{scopedSlots:e._u([{key:"label",fn:function(){return[n("div",[e._v("Способ отображения прогноза")])]},proxy:!0}]),model:{value:e.selectedDisplayType,callback:function(t){e.selectedDisplayType=t},expression:"selectedDisplayType"}},[n("v-radio",{attrs:{label:"Растр",value:"raster"}}),n("v-radio",{attrs:{label:"Вектор",value:"vector"}})],1)],1)],1)],1),n("v-row",{staticClass:"pa-0"},[n("v-col",{staticClass:"pa-0"},[e._v(" Индекс ")])],1),n("v-row",{staticClass:"pa-0",attrs:{"align-content":"center",justify:"space-between",align:"baseline"}},[n("v-col",{staticClass:"pa-0",attrs:{cols:"2"}},[n("v-checkbox",{attrs:{checked:e.indexActive},on:{change:function(t){return e.setIndexActive(!e.indexActive)}}})],1),n("v-col",{staticClass:"pa-0",attrs:{cols:"8"}},[n("v-select",{attrs:{items:e.indexList,filled:"",dense:"",solo:"",disabled:!e.indexActive},model:{value:e.selectedIndex,callback:function(t){e.selectedIndex=t},expression:"selectedIndex"}})],1),n("v-col",{staticClass:"pa-0",attrs:{cols:"2"}},[n("v-btn",{staticClass:"mx-4",attrs:{icon:""},on:{click:function(t){e.dialog=!0,e.menusection="index"}}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-information ")])],1)],1)],1),n("v-dialog",{attrs:{width:"500"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5 grey lighten-2"},[e._v(" Дополнительная информация ")]),n("v-card-text",[e._v(" "+e._s(e.modalinfo[e.menusection])+" ")]),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" Закрыть ")])],1)],1)],1)],1)],1)},ee=[],te={name:"Options",components:{},data:function(){return{forecastTypes:["00","12"],models:[],eventGroups:[],indexList:[],dialog:!1,modalinfo:{model:"Модель",eventgroup:"Группа явлений",forecasttime:"Время прогноза",index:"Диагностические переменные"},menusection:"model"}},computed:Object(u["a"])(Object(u["a"])({},Object(E["e"])({isVisible:"isConfigVisible"})),{},{selectedModel:{get:function(){return this.$store.state.selectedModel},set:function(e){this.setModel(e)}},selectedEvent:{get:function(){return this.$store.state.selectedEvent},set:function(e){this.setSelectedEvent(e)}},selectedIndex:{get:function(){return this.$store.state.selectedIndex},set:function(e){this.setSelectedIndex(e)}},indexActive:{get:function(){return this.$store.state.indexActive},set:function(e){this.setIndexActive(e)}},selectedDisplayType:{get:function(){return this.$store.state.selectedDisplayType},set:function(e){this.setDisplayType(e)}}}),watch:{selectedModel:function(){this.getGroups(),this.getIndexes()}},mounted:function(){this.getGroups(),this.getModels(),this.getIndexes()},methods:Object(u["a"])(Object(u["a"])({},Object(E["d"])({setConfigVisibility:"SET_CONFIG_VISIBILITY",setForecastTypes:"SET_FORECAST_TYPE",setModel:"SET_MODEL",setSelectedEvent:"SET_SELECTED_EVENT",setSelectedIndex:"SET_SELECTED_INDEX",setIndexActive:"SET_INDEX_VISIBILITY",setDisplayType:"SET_SELECTED_DISPLAY_TYPE"})),{},{getModels:function(){var e=this;fetch("".concat("http://ogs.psu.ru:5001/api/v1","/models")).then((function(e){return e.json()})).then((function(t){e.models=t.models,e.setModel(t.models[0])})).catch((function(){e.models=[],e.setModel(null)}))},getGroups:function(){var e=this;fetch("".concat("http://ogs.psu.ru:5001/api/v1","/event_groups?model=").concat(this.selectedModel)).then((function(e){return e.json()})).then((function(t){e.eventGroups=t.groups,e.setSelectedEvent(t.groups[0])})).catch((function(){e.eventGroups=[],e.setSelectedEvent(null)}))},getIndexes:function(){var e=this;fetch("".concat("http://ogs.psu.ru:5001/api/v1","/indexes?model=").concat(this.selectedModel)).then((function(e){return e.json()})).then((function(t){e.indexList=t.indexes,e.setSelectedIndex(t.indexes[0])})).catch((function(){e.indexList=[],e.setSelectedIndex(null)}))}})},ne=te,ae=n("b0af"),re=n("99d9"),se=n("ac7c"),oe=n("169a"),ie=n("ce7e"),ce=n("67b6"),le=n("43a6"),ue=n("b974"),de=n("2db4"),pe=n("2fa4"),ve=Object(y["a"])(ne,Z,ee,!1,null,null,null),fe=ve.exports;H()(ve,{VBtn:F["a"],VCard:ae["a"],VCardActions:re["a"],VCardText:re["b"],VCardTitle:re["c"],VCheckbox:se["a"],VCol:Y["a"],VContainer:B["a"],VDialog:oe["a"],VDivider:ie["a"],VIcon:q["a"],VRadio:ce["a"],VRadioGroup:le["a"],VRow:z["a"],VSelect:ue["a"],VSnackbar:de["a"],VSpacer:pe["a"]});var be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-snackbar",{style:{zIndex:1002},attrs:{timeout:"-1",right:"",width:30,app:"",value:e.isVisible}},[n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"10"}},[e._v(" Легенда ")]),n("v-col",{attrs:{cols:"1"}},[n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.setLegendVisibility(!1)}}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" mdi-close ")])],1)],1)],1),e._l(e.legendVector,(function(t,a){return n("v-row",{key:a,staticClass:"pa-0 ma-n2 legendLabel",attrs:{align:"center"}},[n("v-col",{attrs:{cols:"2"}},[n("div",{style:{backgroundColor:t.color,width:"20px",height:"20px"}})]),n("v-col",{attrs:{cols:"10"}},[n("span",{staticClass:"legendLabel"},[e._v(" "+e._s(t.alias)+" "),n("br"),e._v(" "+e._s("Уровень риска "+t.levelCode+" ")+" ")])]),n("v-row")],1)})),e.indexActive?n("v-row",{staticClass:"pa-0 ma-n2 legendLabel"},[n("v-col",{attrs:{cols:"1"}},[n("div",{staticClass:"color",style:{"background-image":"linear-gradient(to bottom, "+e.indexColor.join(",")+")"}})]),n("v-col",{attrs:{cols:"2"}},[n("div",[n("div",{staticClass:"rasterColorMapFirstValue"},[e._v(" "+e._s(parseInt(e.indexRange[0]))+" ")]),n("div",[e._v(e._s(parseInt(e.indexRange[1])))])])]),n("v-col",{attrs:{cols:"9"}},[e._v(" Значения вспомогательного растра ")])],1):e._e(),"raster"===e.selectedDisplayType?n("v-row",{staticClass:"pa-0 ma-n2 legendLabel"},[n("v-col",{attrs:{cols:"1"}},[n("div",{staticClass:"color",style:{"background-image":"linear-gradient(to bottom, "+e.riskColor.join(",")+")"}})]),n("v-col",{attrs:{cols:"2"}},[n("div",[n("div",{staticClass:"rasterColorMapFirstValue"},[e._v(" "+e._s(parseInt(e.indexRange[0]))+" ")]),n("div",[e._v(e._s(parseInt(e.indexRange[1])))])])]),n("v-col",{attrs:{cols:"9"}},[e._v(" Уровень риска ")])],1):e._e()],2)],1)},ge=[],he={name:"Legend",components:{},data:function(){return{snackbar:!0,legendVector:[]}},computed:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(E["c"])(["SELECTED_EVENT_GROUP"])),Object(E["e"])(["selectedModel","selectedDisplayType","indexActive","colorRange","indexRange","riskColor","indexColor"])),Object(E["e"])({isVisible:"isLegendVisible"})),watch:{selectedDisplayType:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("vector"!==e){n.next=4;break}return n.next=3,t.getVectorLegend();case 3:t.legendVector=n.sent;case 4:"raster"===e&&(t.legendVector=[]);case 5:case"end":return n.stop()}}),n)})))()},SELECTED_EVENT_GROUP:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getVectorLegend();case 2:e.legendVector=t.sent;case 3:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getVectorLegend();case 2:e.legendVector=t.sent;case 3:case"end":return t.stop()}}),t)})))()},methods:Object(u["a"])(Object(u["a"])({},Object(E["d"])({setLegendVisibility:"SET_LEGEND_VISIBILITY"})),{},{getVectorLegend:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,a,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.SELECTED_EVENT_GROUP){t.next=2;break}return t.abrupt("return",[]);case 2:return n="".concat("http://ogs.psu.ru:5001/api/v1","/get_legend?"),a=["model=".concat(e.selectedModel),"group=".concat(e.SELECTED_EVENT_GROUP)],r=n+a.join("&"),t.next=7,fetch(r).then((function(e){return e.json()}));case 7:return s=t.sent,t.abrupt("return",s);case 9:case"end":return t.stop()}}),t)})))()}})},me=he,Ee=(n("8cd0"),Object(y["a"])(me,be,ge,!1,null,"d7cbb2b0",null)),_e=Ee.exports;H()(Ee,{VBtn:F["a"],VCol:Y["a"],VContainer:B["a"],VIcon:q["a"],VRow:z["a"],VSnackbar:de["a"]});var xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{"max-width":"600px","hide-overlay":""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({attrs:{icon:""}},a),[n("v-icon",[e._v(" mdi-login ")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-h5"},[e._v("Войти")])]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Логин*",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Пароль*",type:"password",required:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1)],1),n("small",[e._v("*indicates required field")])],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" Закрыть ")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.login({username:e.username,password:e.password})}}},[e._v(" Войти ")])],1)],1)],1)},ye=[],Ce={name:"Auth",data:function(){return{dialog:!1,username:null,password:null}},methods:Object(u["a"])(Object(u["a"])({},Object(E["b"])({login:"login"})),{},{auth:function(){var e="".concat("http://ogs.psu.ru:5001/api/v1","/auth/token");fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((function(e){return e.json()})).then((function(e){return e.access?alert("Success"):Promise.reject("Error auth")})).catch((function(){return alert("Error")}))}})},Te=Ce,Oe=n("8654"),De=Object(y["a"])(Te,xe,ye,!1,null,"613dc12d",null),Ve=De.exports;H()(De,{VBtn:F["a"],VCard:ae["a"],VCardActions:re["a"],VCardText:re["b"],VCardTitle:re["c"],VCol:Y["a"],VContainer:B["a"],VDialog:oe["a"],VIcon:q["a"],VRow:z["a"],VSpacer:pe["a"],VTextField:Oe["a"]});var Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.flag?n("v-dialog",{attrs:{"max-width":"600px","hide-overlay":""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({attrs:{icon:""}},a),[n("v-icon",[e._v(" mdi-clipboard-list-outline ")])],1)]}}],null,!1,1242349225),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",[e._v("Заказать оповещение для определенной точки (в радиусе 20 км)")])]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Долгота (X) 59.59",required:""},model:{value:e.X,callback:function(t){e.X=t},expression:"X"}})],1),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Широта (Y) 59.59",required:""},model:{value:e.Y,callback:function(t){e.Y=t},expression:"Y"}})],1),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Ник в телеграме для отправки сообщений (@username)",required:""},model:{value:e.telegramNick,callback:function(t){e.telegramNick=t},expression:"telegramNick"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" Закрыть ")]),n("v-btn",{attrs:{color:"blue darken-1",text:""}},[e._v(" Запросить ")])],1)],1)],1):e._e()},je=[],Le={data:function(){return{flag:!1,dialog:!1,X:null,Y:null,telegramNick:null}},name:"OrderNotification",computed:Object(u["a"])({},Object(E["e"])({isAuth:function(e){return e.auth.status}})),watch:{isAuth:function(e){"success"===e&&(this.flag=!0)}}},ke=Le,we=Object(y["a"])(ke,Se,je,!1,null,"26eea894",null),Ie=we.exports;H()(we,{VBtn:F["a"],VCard:ae["a"],VCardActions:re["a"],VCardText:re["b"],VCardTitle:re["c"],VCol:Y["a"],VContainer:B["a"],VDialog:oe["a"],VIcon:q["a"],VRow:z["a"],VSpacer:pe["a"],VTextField:Oe["a"]});var Re={name:"App",components:{OrderNotification:Ie,Auth:Ve,Map:R,Footer:Q,Options:fe,Legend:_e},data:function(){return{}}},Me=Re,Ae=n("7496"),Ne=n("40dc"),Pe=n("f6c4"),Ue=Object(y["a"])(Me,o,i,!1,null,null,null),Ge=Ue.exports;H()(Ue,{VApp:Ae["a"],VAppBar:Ne["a"],VMain:Pe["a"],VSpacer:pe["a"]});var He=n("f309");s["a"].use(He["a"]);var Fe=new He["a"]({}),Ye={state:{status:"not success",token:localStorage.getItem("token")||"",user:{}},getters:{},mutations:{auth_request:function(e){e.status="loading"},auth_success:function(e,t){e.status="success",e.token=t.token},auth_error:function(e){e.status="error"},logout:function(e){e.status="",e.token=""}},actions:{login:function(e,t){var n=e.commit;return new Promise((function(e,a){n("auth_request");var r="".concat("http://ogs.psu.ru:5001/api/v1","/auth/token");fetch(r,{body:JSON.stringify(t),method:"POST",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var a=t.access,r={};localStorage.setItem("token",a),n("auth_success",{token:a,user:r}),e(t)})).catch((function(e){n("auth_error"),localStorage.removeItem("token"),a(e)}))}))}}},Be=n("2909"),$e=(n("b0c0"),{state:{isConfigVisible:!1,isLegendVisible:!1,selectedDate:null,selectedModel:"gfs",selectedEvent:null,selectedIndex:null,indexActive:!1,selectedDisplayType:"vector",indexRange:[0,0],riskRange:[4,0],indexColor:["yellow","#008ae5"],riskColor:["#ff9999","#330000"],forecastHours:[{value:0,label:"00:00"},{value:3,label:"03:00"},{value:6,label:"06:00"},{value:9,label:"09:00"},{value:12,label:"12:00"},{value:15,label:"15:00"},{value:18,label:"18:00"},{value:21,label:"21:00"},{value:24,label:"24:00"}]},getters:{SELECTED_HOUR:function(e){if(!e.selectedDate)return"";var t=e.selectedDate.getUTCHours(),n=e.forecastHours.map((function(e){return e.value})),a=n.map((function(e){return Math.abs(t-e)})),r=n[a.indexOf(Math.min.apply(Math,Object(Be["a"])(a)))];return 0===r?"24":r<10?"0".concat(r):"".concat(r)},SELECTED_DATE:function(e,t){return e.selectedDate?"24"===t.SELECTED_HOUR?N(new Date(e.selectedDate.setUTCDate(e.selectedDate.getUTCDate()-1))):N(e.selectedDate):""},SELECTED_EVENT_GROUP:function(e){return e.selectedEvent?e.selectedEvent.name:null}},mutations:{SET_CONFIG_VISIBILITY:function(e,t){e.isConfigVisible=t},SET_LEGEND_VISIBILITY:function(e,t){e.isLegendVisible=t},SET_MODEL:function(e,t){e.selectedModel=t},SET_SELECTED_EVENT:function(e,t){e.selectedEvent=t},SET_SELECTED_INDEX:function(e,t){e.selectedIndex=t},SET_SELECTED_DATE:function(e,t){e.selectedDate=t},SET_INDEX_VISIBILITY:function(e,t){e.indexActive=t},SET_SELECTED_DISPLAY_TYPE:function(e,t){e.selectedDisplayType=t},SET_INDEX_RANGE:function(e,t){e.indexRange=t}}});s["a"].use(E["a"]);var qe=new E["a"].Store(Object(u["a"])(Object(u["a"])({},$e),{},{modules:{auth:Ye}}));n("6cc5");s["a"].config.productionTip=!1,new s["a"]({vuetify:Fe,store:qe,render:function(e){return e(Ge)}}).$mount("#app")},"68a6":function(e,t,n){},"8cd0":function(e,t,n){"use strict";n("68a6")},b966:function(e,t,n){"use strict";n("be5c")},be5c:function(e,t,n){}});
//# sourceMappingURL=app.89d9fde4.js.map